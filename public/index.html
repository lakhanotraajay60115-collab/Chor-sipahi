<!DOCTYPE html>
<html lang="gu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate="title">рк░рк╛ркЬрк╛-рк░рк╛ркгрлА-рк╡ркЬрлАрк░-ркЪрлЛрк░</title>

    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <style>
        :root {
            --king-color: #ffd700;
            --queen-color: #ff69b4;
            --minister-color: #1e90ff;
            --thief-color: #555;
            --sipahi-color: #28a745; /* рк╕рк┐рккрк╛рк╣рлА ркорк╛ркЯрлЗ ркирк╡рлЛ рк░ркВркЧ */
            --primary-color: #8a2be2; 
            --background-color: #f5f5f5;
            --card-background: #ffffff;
        }
        /* ... (ркЕркирлНркп CSS ркХрлЛркб рк╕ркорк╛рки) ... */
        .role-sipahi { background-color: var(--sipahi-color); } /* рк╕рк┐рккрк╛рк╣рлА ркорк╛ркЯрлЗ CSS ркЙркорлЗрк░рлЛ */
        /* ... (ркЕркирлНркп CSS ркХрлЛркб рк╕ркорк╛рки) ... */

    </style>
</head>
<body>
<div class="game-container">
    
    <div class="lang-selector" style="display: none;"> 
        <label for="language-select" data-translate="languageLabel">ркнрк╛рк╖рк╛:</label>
        <select id="language-select" onchange="handleLanguageChange(this.value)">
            <option value="gu">ркЧрлБркЬрк░рк╛ркдрлА</option>
            <option value="hi">рд╣рд┐рдиреНрджреА</option>
            <option value="en">English</option>
        </select>
    </div>

    <h1 data-translate="appTitle">ЁЯСС рк░рк╛ркЬрк╛-рк░рк╛ркгрлА-рк╡ркЬрлАрк░-ркЪрлЛрк░ ЁЯГП</h1>
    
    <p id="gameStatus" data-translate="connecting">ркХркирлЗркХрлНркЯрк┐ркВркЧ...</p>

    <div id="nameRegistration">
        <input type="text" id="playerNameInput" placeholder="ркдркорк╛рк░рлБркВ ркирк╛рко ркжрк╛ркЦрк▓ ркХрк░рлЛ" required style="width: 100%; padding: 10px; box-sizing: border-box; margin-bottom: 10px;">
        <button id="registerButton" data-translate="registerButton">ркЬрлЛркбрк╛ркУ (Join)</button>
    </div>

    <div id="mainGame" style="display: none;">
        <p id="roundInfo" data-translate-template="roundInfo">рк░рк╛ркЙркирлНркб: рлж/рлзрлж</p>
        
        <div id="roleDisplay">ркдркорк╛рк░рлА ркнрлВркорк┐ркХрк╛: ?</div>

        <div id="voteSection">
            <h3 data-translate="votePrompt">ркХрлЛркг ркЪрлЛрк░ ркЫрлЗ? рк╡рлЛркЯ ркХрк░рлЛ:</h3>
            <div id="voteForm" style="display: flex; flex-direction: column;">
                </div>
            <button id="submitVoteButton" data-translate="submitVote">рк╡рлЛркЯ рк╕ркмркорк┐ркЯ ркХрк░рлЛ</button>
        </div>

        <div id="chatSection">
            <h3 data-translate="chatTitle">ркЦрлЗрк▓рк╛ркбрлАркУ рк╕рк╛ркерлЗ рк╡рк╛ркдркЪрлАркд (ркорк╛ркЗркХрлНрк░рлЛрклрлЛрки ркЪрлЗркЯркирлЗ ркмркжрк▓рлЗ)</h3>
            <div id="chatBox"></div>
            <div id="chatInputContainer">
                <input type="text" id="chatMessageInput" data-translate-placeholder="chatPlaceholder" placeholder="ркорлЗрк╕рлЗркЬ рк▓ркЦрлЛ...">
                <button id="sendChatButton" data-translate="sendButton">ркорлЛркХрк▓рлЛ</button>
            </div>
        </div>
        
    </div>
    
    <div id="resultDisplay" style="display: none;"></div>
    <div id="scoreDisplay">
        <h3 data-translate="totalScoreTitle">ЁЯПЖ ркХрлБрк▓ рк╕рлНркХрлЛрк░</h3>
        <ul id="scoreList"></ul>
    </div>
    
    <div id="playerList">
        <h3 data-translate="activePlayersTitle">рк╕ркХрлНрк░рк┐ркп ркЦрлЗрк▓рк╛ркбрлАркУ</h3>
        <ul id="playerNamesList"></ul>
    </div>
</div>

<script src="/socket.io/socket.io.js"></script> 

<script>
    const socket = io(); 
    let myId = null;
    let players = {};
    let myRole = '';
    let currentLang = 'gu'; 
    let isHost = false;

    // ркорк╣ркдрлНркдрко ркЦрлЗрк▓рк╛ркбрлАркУ рк╕рк░рлНрк╡рк░ рккрк░ рк╕рлЗркЯ ркЫрлЗ, рккркг ркЕрк╣рлАркВ MAX_PLAYERS ркирлЗ 8 ркдрк░рлАркХрлЗ ркзрк╛рк░рлАркП ркЫрлАркП
    const MAX_PLAYERS = 8;
    const MIN_PLAYERS = 4;

    // --- ркнрк╛рк╖рк╛ркВркдрк░ ркорк╛ркЯрлЗркирлЛ ркорлБркЦрлНркп ркбрлЗркЯрк╛ ркСркмрлНркЬрлЗркХрлНркЯ ---
    const translations = {
        gu: {
            // ... (ркЕркирлНркп ркЯрлНрк░рк╛ркирлНрк╕рк▓рлЗрк╢рки рк╕ркорк╛рки) ...
            'рк░рк╛ркЬрк╛': 'рк░рк╛ркЬрк╛', 'рк░рк╛ркгрлА': 'рк░рк╛ркгрлА', 'рк╡ркЬрлАрк░': 'рк╡ркЬрлАрк░', 'ркЪрлЛрк░': 'ркЪрлЛрк░', 
            'рк╕рк┐рккрк╛рк╣рлА': 'рк╕рк┐рккрк╛рк╣рлА', // ркирк╡рлБркВ
            title: "рк░рк╛ркЬрк╛-рк░рк╛ркгрлА-рк╡ркЬрлАрк░-ркЪрлЛрк░",
            appTitle: "ЁЯСС рк░рк╛ркЬрк╛-рк░рк╛ркгрлА-рк╡ркЬрлАрк░-ркЪрлЛрк░ ЁЯГП",
            // ...
            roundInfo: (round, max) => `рк░рк╛ркЙркирлНркб: ${round}/${max}`,
            waiting: (count) => `ркЦрлЗрк▓рк╛ркбрлАркУркирлА рк░рк╛рк╣ ркЬрлЛрк╡рк╛ркп ркЫрлЗ... (${count}/${MAX_PLAYERS})`, // ркЕрккркбрлЗркЯ ркеркпрлБркВ
            // ... (ркЕркирлНркп ркЯрлНрк░рк╛ркирлНрк╕рк▓рлЗрк╢рки рк╕ркорк╛рки) ...
        },
        hi: {
            // ... (ркЕркирлНркп ркЯрлНрк░рк╛ркирлНрк╕рк▓рлЗрк╢рки рк╕ркорк╛рки) ...
            'рд░рд╛рдЬрд╛': 'рд░рд╛рдЬрд╛', 'рд░рд╛рдиреА': 'рд░рд╛рдиреА', 'рд╡рдЬреАрд░': 'рд╡рдЬреАрд░', 'рдЪреЛрд░': 'рдЪреЛрд░',
            'рд╕рд┐рдкрд╛рд╣реА': 'рд╕рд┐рдкрд╛рд╣реА', // ркирк╡рлБркВ
            title: "рд░рд╛рдЬрд╛-рд░рд╛рдиреА-рд╡рдЬреАрд░-рдЪреЛрд░",
            appTitle: "ЁЯСС рд░рд╛рдЬрд╛-рд░рд╛рдиреА-рд╡рдЬреАрд░-рдЪреЛрд░ ЁЯГП",
            // ...
            roundInfo: (round, max) => `рд░рд╛рдЙрдВрдб: ${round}/${max}`,
            waiting: (count) => `рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХрд╛ рдЗрдВрддрдЬрд╝рд╛рд░ рд╣реИ... (${count}/${MAX_PLAYERS})`, // ркЕрккркбрлЗркЯ ркеркпрлБркВ
            // ... (ркЕркирлНркп ркЯрлНрк░рк╛ркирлНрк╕рк▓рлЗрк╢рки рк╕ркорк╛рки) ...
        },
        en: {
            // ... (ркЕркирлНркп ркЯрлНрк░рк╛ркирлНрк╕рк▓рлЗрк╢рки рк╕ркорк╛рки) ...
            'King': 'King', 'Queen': 'Queen', 'Minister': 'Minister', 'Thief': 'Thief',
            'рк╕рк┐рккрк╛рк╣рлА': 'Guard', // ркирк╡рлБркВ (ркЧрлБркЬрк░рк╛ркдрлА ркХрлА ркирлЛ ркЙрккркпрлЛркЧ ркЕркВркЧрлНрк░рлЗркЬрлА рк╡рлЗрк▓рлНркпрлБ ркорк╛ркЯрлЗ)
            title: "Raja-Rani-Vazir-Chor",
            appTitle: "ЁЯСС Raja-Rani-Vazir-Chor ЁЯГП",
            // ...
            roundInfo: (round, max) => `Round: ${round}/${max}`,
            waiting: (count) => `Waiting for players... (${count}/${MAX_PLAYERS})`, // ркЕрккркбрлЗркЯ ркеркпрлБркВ
            // ... (ркЕркирлНркп ркЯрлНрк░рк╛ркирлНрк╕рк▓рлЗрк╢рки рк╕ркорк╛рки) ...
        }
    };

    const roleColors = {
        'рк░рк╛ркЬрк╛': 'role-king', 'рк░рк╛ркгрлА': 'role-queen', 'рк╡ркЬрлАрк░': 'role-minister', 'ркЪрлЛрк░': 'role-thief',
        'рк╕рк┐рккрк╛рк╣рлА': 'role-sipahi', // рк╕рк┐рккрк╛рк╣рлА рк░рлЛрк▓ ркХрк▓рк░ ркЙркорлЗрк░рк╛ркпрлЛ
        // ... (ркЕркирлНркп ркнрк╛рк╖рк╛ркирк╛ рк░рлЛрк▓ ркХрк▓рк░рлНрк╕ рк╕ркорк╛рки)
        'рд░рд╛рдЬрд╛': 'role-king', 'рд░рд╛рдиреА': 'role-queen', 'рд╡рдЬреАрд░': 'role-minister', 'рдЪреЛрд░': 'role-thief',
        'рд╕рд┐рдкрд╛рд╣реА': 'role-sipahi', 
        'King': 'role-king', 'Queen': 'role-queen', 'Minister': 'role-minister', 'Thief': 'role-thief',
        'Guard': 'role-sipahi' // ркЕркВркЧрлНрк░рлЗркЬрлА ркорк╛ркЯрлЗ
    };
    
    // ... (ркмрк╛ркХрлАркирк╛ ркмркзрк╛ рк╕рлЛркХрлЗркЯ ркЕркирлЗ UI рк▓рлЛркЬрк┐ркХ рк╕ркорк╛рки) ...
    // ... (ркЦрк╛рк╕ ркХрк░рлАркирлЗ playerListUpdate ркорк╛ркВ MIN_PLAYERS ркирлЗ ркмркжрк▓рлЗ count < MIN_PLAYERS ркирлЛ ркЙрккркпрлЛркЧ ркерк╢рлЗ)
    
    // serverFull ркорлЗрк╕рлЗркЬ рк╣рлЗркирлНркбрк▓ ркХрк░рлЛ
    socket.on('serverFull', () => {
        alert("ркЧрлЗрко рк░рлВрко рклрлВрк▓ ркЫрлЗ. ркорк╣ркдрлНркдрко рло ркЦрлЗрк▓рк╛ркбрлАркУ ркЬ рк░ркорлА рк╢ркХрлЗ ркЫрлЗ.");
        window.location.reload(); 
    });
    
    // ... (ркмрк╛ркХрлАркирлЛ ркХрлЛркб рк╕ркорк╛рки) ...

</script>

</body>
</html>
